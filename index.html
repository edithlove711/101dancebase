<!DOCTYPE html>
<html>
  <head>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>101DANCEBASE 課程預約中...</title>
  </head>
  <body style="display:flex;justify-content:center;align-items:center;height:100vh;font-family:sans-serif;">
    <h3 id="status">請稍候，正在開啟預約表單...</h3>

    <script>
      async function main() {
        try {
          document.getElementById("status").innerText = "初始化 LIFF 中...";
          await liff.init({ liffId: "2007694269-P5MJkAJ7" });

          let userId = "";
          if (liff.isLoggedIn()) {
            const profile = await liff.getProfile();
            userId = profile.userId;
          }

          const formBase = "https://docs.google.com/forms/d/e/1FAIpQLSf-JyFPiZX_PH8hwLJo4KsBzgVhqV-6jmsLJ0CZDPWQK-ciTQ/viewform";
          const entryParam = "entry.1129681516=" + encodeURIComponent(userId);
          const fullUrl = `${formBase}?${entryParam}`;

          document.getElementById("status").innerText = "跳轉中...";
          window.location.replace(fullUrl);

        } catch (err) {
          document.getElementById("status").innerText = "錯誤：" + err.message;
          console.error(err);
        }
      }

      main();
    </script>
  </body>
</html>
